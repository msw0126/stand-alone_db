function save_csv(e){save_load_gif(e,!0);var a=$("#csv-main").attr("data"),t=$("#fileName").val(),o=$("#files").val(),s=o.replace(/.*(\/|\\)/,""),l=$("#reader_enname").val(),n=JSON.parse(sessionStorage.getItem("csvloadid"));null!=n&&l!=n.data[0].tableName&&(robotx_stus=!0);var i=[];console.log(t),i.push({type:"reader",componentID:a,projectID:proid,fileName:t,fileVal:s,tableName:l,separator:separator}),xml='{"data":'+JSON.stringify(i)+"}",sessionStorage.setItem(a,xml),save_load_gif(e,!1),layer.alert("保存成功!",{icon:1,title:"提示"})}function progressFunction(e){if($(".files_name ").removeClass("img_upload"),$(".c-csv-again").addClass("img_upload").show(),$(".c-csv").attr("id","").addClass("c-csv-active"),$(".files_name").next().addClass("c-csv-icon"),e.lengthComputable){console.log(e.total),console.log(e.loaded);var a=e.loaded/e.total;1==a&&(a=.99),$(".files_name").text(Math.round(100*a)+"%")}}$(function(){$(".reader-right-content_ul").on("click",".img_upload",function(){$("#componentID").val($("#csv-main").attr("data")),$("#files").click(),$("#proid").val(proid)}),$("#files").change(function(){var e=new FormData($("#form_reader")[0]);console.log(e);var a=$("#files").val(),t=a.replace(/.*(\/|\\)/,"");$(".files_name").text(t);if(3145728e5>$("#files")[0].files[0].size){var o=new XMLHttpRequest;o.upload.onprogress=function(e){},o.open("post",csv_file_upload),o.onload=function(e){console.log(e),$(".files_name").text(t),robotx_stus=!0,$("#fileName").val(e.detail)},o.upload.addEventListener("progress",progressFunction,!1),o.send(e)}else layer.alert("文件不能超过30Mb",{icon:5,title:"提示"})}),$("#reader_cnname").blur(function(){/^[\u4e00-\u9fa5]+$/.test($("#reader_cnname").val())?$(this).next().hide():$(this).next().show()}),$("#reader_enname").blur(function(){/^[A-Za-z_]+$/.test($("#reader_enname").val())?$(this).next().hide():$(this).next().show()}),$(".c_save_reader").click(function(){$(".reader_error2").is(":hidden")&&(save_load_gif($(this),!0),save_csv($(this)))})});